process.roles=broker,controller
node.id={{ node_id }}
controller.quorum.voters={{ groups['kafka_servers'] | map('extract', hostvars, 'node_id') | zip(groups['kafka_servers'] | map('extract', hostvars, 'ansible_host')) | map('join', '@') | join(',') }}

# network
listeners=PLAINTEXT://{{ ansible_host }}:{{ kafka_port }},CONTROLLER://{{ ansible_host }}:{{ controller_port }}
advertised.listeners=PLAINTEXT://{{ ansible_host }}:{{ kafka_port }}
listener.security.protocol.map=PLAINTEXT:PLAINTEXT,CONTROLLER:PLAINTEXT
listener.name.controller=CONTROLLER
listener.name.plaintext=PLAINTEXT
listener.port=9092
advertised.listeners=PLAINTEXT://{{ ansible_host }}:9092

# 로그 디렉토리 설정
log.dirs={{ kafka_data_dir }}

# 토픽 설정
offsets.topic.replication.factor=3
share.coordinator.state.topic.replication.factor=3
share.coordinator.state.topic.min.isr=2
transaction.state.log.replication.factor=3
transaction.state.log.min.isr=2

# 로그 설정
log.retention.hours=168
log.segment.bytes=1073741824
log.retention.check.interval.ms=300000